<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="unbiasedgoodness">
<title>RP tests • unbiasedgoodness</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RP tests">
<meta property="og:description" content="unbiasedgoodness">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">unbiasedgoodness</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/MLR.html">MLR</a>
    <a class="dropdown-item" href="../articles/RPtests.html">RP tests</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/joftius/unbiasedgoodness/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>RP tests</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joftius/unbiasedgoodness/blob/HEAD/vignettes/RPtests.Rmd" class="external-link"><code>vignettes/RPtests.Rmd</code></a></small>
      <div class="d-none name"><code>RPtests.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="philosophy-based-on-cross-validation">Philosophy based on cross-validation<a class="anchor" aria-label="anchor" href="#philosophy-based-on-cross-validation"></a>
</h3>
<p>In chapter 7 of <span class="citation">Hastie, Tibshirani, and
Friedman (<a href="#ref-ESL2009" role="doc-biblioref">2009</a>)</span>
the authors emphasize cross-validation estimates the expected prediction
error (or generalization error) of a <em>method</em>. This is in
contrast to estimating such errors for a <em>specific model</em>. There
is a line of work that makes use of cross-validation and inherits its
inferential focus on a method rather than a specific model chosen by
that method <span class="citation">(<a href="#ref-wasserman2009" role="doc-biblioref">Wasserman and Roeder 2009</a>; <a href="#ref-meinshausen2009" role="doc-biblioref">Meinshausen, Meier, and
Bühlmann 2009</a>; <a href="#ref-meinshausen2010" role="doc-biblioref">Meinshausen and Bühlmann 2010</a>; <a href="#ref-shah2013" role="doc-biblioref">R. D. Shah and Samworth
2013</a>)</span> including the focus of this vignette which was proposed
by <span class="citation">R. D. Shah and Bühlmann (<a href="#ref-shah2018" role="doc-biblioref">2018</a>)</span>. This paper
and its <code>R</code> implementation <span class="citation">(<a href="#ref-rRPtests" role="doc-biblioref">2021</a>)</span> roughly
attempt to answer the question:</p>
<p><span class="smallcaps"><strong>Does this method (typically) result
in models with a good fit, or does it fail to capture signal that an
alternate method could (typically) detect?</strong></span></p>
<p>If the first method does fit well, then the residuals from that
method should (typically) look like pure noise. On the other hand, if an
alternate method can predict the residuals with good accuracy (better
than noise) that would be evidence the first method is failing to
capture some signal. Hence the name <strong>RPtests</strong>, based on
<strong>r</strong>esidual <strong>p</strong>rediction. The exact details
depend on several (groups of) decisions:</p>
<ol style="list-style-type: decimal">
<li><p>Probability modeling assumptions (foundational, and we will not
question these here).<span class="math display">\[
\mathbf{y} = \mathbf{X} \beta + \sigma \epsilon
\]</span></p></li>
<li><p>The first method, or null method. We want to know if this method
is good enough. <em>We will focus on using the lasso <span class="citation">(<a href="#ref-tibshirani1996" role="doc-biblioref">1996</a>)</span> to select variables</em> in a
(potentially high-dimensional) linear model. (The high level idea could
be applied using other methods as well but that would require changing
some other details in the implementation).</p></li>
<li><p>One or more secondary or alternate methods that could be chosen
depending on what type of model misspecification we are concerned about.
<em>We will focus on whether we should include more predictor
variables</em>, but another possibility is to search for non-linear
relationships. (An alternate method could be a hybrid or ensemble of
several methods, but we will not explore this here).</p></li>
<li><p>Analysis/pipeline choices including how to tune each method,
estimating the variance of the noise, number of bootstrap samples, and
so on. (We will also not question these here).</p></li>
</ol>
<p>We’ll focus on one of the main cases investigated in <span class="citation">(<a href="#ref-shah2018" role="doc-biblioref">R. D.
Shah and Bühlmann 2018</a>)</span>: testing a linear model against an
alternative that includes additional predictors. To determine if the
alternative predicts the residuals significantly better than noise the
paper uses a parametric-residual bootstrap described below, but first we
consider an important point about the dimension of the first (null)
model.</p>
</div>
<div class="section level3">
<h3 id="low-vs-high-dimensions">Low vs high-dimensions<a class="anchor" aria-label="anchor" href="#low-vs-high-dimensions"></a>
</h3>
<p>In the low dimensional linear model case, the scaled residuals</p>
<p><span class="math display">\[
\hat{\mathbf{R}} = \frac{(\mathbf{I} -
\mathbf{P})\mathbf{y}}{\|(\mathbf{I} - \mathbf{P})\mathbf{y}\|_2}
\]</span></p>
<p>are a pivotal quantity under the null hypothesis that the model fits
(and <span class="math inline">\(\mathbf P = \mathbf{X}(\mathbf{X}^T
\mathbf{X})^{-1} \mathbf{X}^T\)</span> is the projection or hat matrix).
In this case the distribution of the residuals does not depend on any
unknown parameters, so we can use that distribution for valid hypothesis
tests or other inferences. This is the basis of the standard <span class="math inline">\(F\)</span>-test for goodness-of-fit, the one
reported at the end of a <code>summary(lm(y ~ x))</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ x)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -1.9115 -0.5747 -0.1463  0.5103  2.2936 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">#&gt; (Intercept)  0.06272    0.29121   0.215   0.8304  </span></span>
<span><span class="co">#&gt; x            1.06779    0.48788   2.189   0.0335 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.9297 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.09074,    Adjusted R-squared:  0.0718 </span></span>
<span><span class="co">#&gt; F-statistic:  4.79 on 1 and 48 DF,  p-value: 0.03352</span></span></code></pre></div>
<p>However, this does not work in the high-dimensional case, so <span class="citation">(<a href="#ref-shah2018" role="doc-biblioref">2018</a>)</span> use a combination of previous
lasso theory and new technical results to prove the residuals from lasso
can be used in a similar way (with slight modifications) to construct
tests. The theory relies on fairly standard but strong conditions
sufficient for the lasso to estimate the support and signs of the true
<span class="math inline">\(\beta\)</span> with high probability, but
(as is typical in lasso theory literature) simulations show good
empirical performance under more general settings where the strong
sufficient conditions are relaxed.</p>
<p>We briefly note that <span class="citation">Janková et al. (<a href="#ref-jankova2020" role="doc-biblioref">2020</a>)</span> apply the
same basic idea of predicting residuals to high-dimensional
<em>generalized</em> linear models by using the Pearson residuals</p>
<p><span class="math display">\[
\hat R_i = \frac{Y_i - \mu(x_i^T \hat \beta)}{\sqrt{V(x_i^T \hat
\beta)}}
\]</span></p>
<p>instead, where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(V\)</span> are the conditional mean and variance
functions, respectively. However, beyond the basic idea there is much
additional work involved in this other case so we do not consider it
more here.</p>
<div class="section level4">
<h4 id="lasso-details">Lasso details<a class="anchor" aria-label="anchor" href="#lasso-details"></a>
</h4>
<p>To calibrate the test, we need a distribution to compare the accuracy
measure (typically) achieved by a null model. In the high-dimensional
case the null model is assumed to be selected by lasso with
cross-validation. The authors propose iterating the whole procedure
multiple times to average over the randomness induced by
cross-validation itself. Note that this makes more sense when our
inferential focus is the <em>method</em> and not a <em>specific
model</em> chosen by the method. Below is a restatement of Algorithm 1
in <span class="citation">(<a href="#ref-shah2018" role="doc-biblioref">2018</a>)</span>, the parametric-residual bootstrap
procedure for estimating a null distribution. For <span class="math inline">\(b = 1, \ldots, B\)</span>:</p>
<ol style="list-style-type: decimal">
<li>Replace <span class="math inline">\(\mathbf{y}\)</span> with <span class="math inline">\(\mathbf{\hat y}\)</span> from the original null
model plus simulated residuals <span class="math inline">\(\mathbf{\zeta}^{(b)} \sim N(0, \mathbf{I}_{n
\times n})\)</span>. (Simulating a new response from the null
model).<br>
</li>
<li>Fit sqrt-lasso <span class="citation">(<a href="#ref-belloni2011" role="doc-biblioref">2011</a>)</span> using the above simulated <span class="math inline">\(\mathbf{y}^{(b)}\)</span> and subtract new fit
<span class="math inline">\(\mathbf{\hat y}^{(b)}\)</span>. (Simulating
residuals achieved by alternative method).<br>
</li>
<li>Normalize simulated residuals and compute some accuracy measure,
such as RSS. (Obtain bootstrap distribution for testing).<br>
</li>
</ol>
<p>Note that the sqrt-lasso method can be replaced with other fitting
procedures if we are interested in different alternatives, for example
by using a tree based method if we are interested in predictive
interactions.</p>
<p>Exercise: why not just predict normalized residuals <span class="math inline">\((\mathbf{y} - \mathbf{\hat y})/\hat
\sigma\)</span> and compare to accuracy in predicting <span class="math inline">\(\mathbf{\zeta}^{(b)}\)</span>? (Consider
dimensions).</p>
</div>
</div>
<div class="section level3">
<h3 id="simulations-and-examples">Simulations and examples<a class="anchor" aria-label="anchor" href="#simulations-and-examples"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/rssb.12234" class="external-link">RPtests</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">hdi</span><span class="op">)</span> <span class="co"># riboflavin dataset</span></span>
<span><span class="co">#&gt; Loading required package: scalreg</span></span>
<span><span class="co">#&gt; Loading required package: lars</span></span>
<span><span class="co">#&gt; Loaded lars 1.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2</span> 3.3.6     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr  </span> 1.0.9</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble </span> 3.1.8     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr</span> 1.4.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr  </span> 1.2.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr  </span> 2.1.2</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># this shouldn't be necessary?</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">unbiasedgoodness</span></span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joftius/unbiasedgoodness" class="external-link">unbiasedgoodness</a></span><span class="op">)</span></span></code></pre></div>
<p>We continue focusing on the high-dimensional linear model and as an
alternative to a selected model we consider whether more variables
should be included. Since <span class="citation">(<a href="#ref-shah2018" role="doc-biblioref">2018</a>)</span> are not
trying to do selective inference in their simulations it seems there is
no model selection involved in choosing the hypotheses. Type 1 error
control is shown in simulations set up for the null to be true in all
instances, rather than doing model selection and subsetting to instances
where the null holds (as in selective inference).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">s0</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/hdi/man/rXb.html" class="external-link">rXb</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">s0</span>, xtype <span class="op">=</span> <span class="st">"equi.corr"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">$</span><span class="va">beta</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="co"># True support</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">beta</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4 5</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gof_RPtest.html">gof_RPtest</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in gof_RPtest(x, y): Sparsity of 1 chosen by cv.glmnet, forcing to 2 for RPtest compatibility</span></span>
<span><span class="co">#&gt; $selected_support</span></span>
<span><span class="co">#&gt; [1]   5 139</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alt_support</span></span>
<span><span class="co">#&gt; [1]   3   4  85 133 166 190</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pval_lasso</span></span>
<span><span class="co">#&gt; [1] 0.02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pval_OLS</span></span>
<span><span class="co">#&gt; [1] 0.02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pval_full</span></span>
<span><span class="co">#&gt; [1] 0.02</span></span></code></pre></div>
<p>Iterate</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#devtools::load_all() # this shouldn't be necessary?</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joftius/unbiasedgoodness" class="external-link">unbiasedgoodness</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">s0</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="fu">simulate_gof_instance</span><span class="op">(</span><span class="va">m</span>, b <span class="op">=</span> <span class="fl">10</span>, <span class="va">n</span>, <span class="va">p</span>, <span class="va">s0</span><span class="op">)</span></span>
<span><span class="co">#&gt;    max_corr   min_beta s_null s_alt null_intersection alt_intersection  null</span></span>
<span><span class="co">#&gt; 1 0.5636253 0.03821633      4     6                 4                4 FALSE</span></span>
<span><span class="co">#&gt;     alt pval_lasso pval_OLS pval_full</span></span>
<span><span class="co">#&gt; 1 FALSE       0.04     0.04      0.52</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#devtools::load_all() # this shouldn't be necessary?</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joftius/unbiasedgoodness" class="external-link">unbiasedgoodness</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">niters</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">simulate_gof</span><span class="op">(</span><span class="va">niters</span>, <span class="va">m</span>, b <span class="op">=</span> <span class="fl">10</span>, <span class="va">n</span>, <span class="va">p</span>, <span class="va">s0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in gof_RPtest(x, y): Sparsity of 1 chosen by cv.glmnet, forcing to 2 for RPtest compatibility</span></span>
<span></span>
<span><span class="co">#&gt; Warning in gof_RPtest(x, y): Sparsity of 1 chosen by cv.glmnet, forcing to 2 for RPtest compatibility</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">null</span><span class="op">)</span>,</span>
<span>            alt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">alt</span><span class="op">)</span>,</span>
<span>            s_null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_null</span><span class="op">)</span>,</span>
<span>            s_alt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_alt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    null   alt s_null s_alt</span></span>
<span><span class="co">#&gt; 1 0.452 0.548  8.756 7.774</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pval_OLS</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">null</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pval_full</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">null</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pval_lasso</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">null</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="checking">checking<a class="anchor" aria-label="anchor" href="#checking"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">null_intersection</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">alt_intersection</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">s_alt</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">max_corr</span>, <span class="va">null_intersection</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">min_beta</span>, <span class="va">null_intersection</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">null_intersection</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="RPtests_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="section level4">
<h4 id="rptests-controls-selective-error">RPtests controls selective error<a class="anchor" aria-label="anchor" href="#rptests-controls-selective-error"></a>
</h4>
<p>To the best of my knowledge it is not known whether
<strong>RPtests</strong> is valid for <strong>selective
inference</strong> since it was not designed or proven to do so. This
empirical demonstration may be a novel result showing that, at least in
the conditions simulated here, the method does control selective
errors.</p>
<div class="section level5">
<h5 id="selective-type-1-error">Selective type 1 error<a class="anchor" aria-label="anchor" href="#selective-type-1-error"></a>
</h5>
</div>
<div class="section level5">
<h5 id="selective-unbiasedness-and-power">Selective unbiasedness and power<a class="anchor" aria-label="anchor" href="#selective-unbiasedness-and-power"></a>
</h5>
</div>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-belloni2011" class="csl-entry">
Belloni, A., V. Chernozhukov, and L. Wang. 2011. <span>“Square-Root
Lasso: Pivotal Recovery of Sparse Signals via Conic Programming.”</span>
<em>Biometrika</em> 98 (4): 791–806. <a href="https://doi.org/10.1093/biomet/asr043" class="external-link">https://doi.org/10.1093/biomet/asr043</a>.
</div>
<div id="ref-ESL2009" class="csl-entry">
Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em>The
<span>Elements</span> of <span>Statistical</span>
<span>Learning</span></em>. Springer <span>Series</span> in
<span>Statistics</span>. New York, NY: Springer New York. <a href="https://doi.org/10.1007/978-0-387-84858-7" class="external-link">https://doi.org/10.1007/978-0-387-84858-7</a>.
</div>
<div id="ref-jankova2020" class="csl-entry">
Janková, Jana, Rajen D. Shah, Peter Bühlmann, and Richard J. Samworth.
2020. <span>“Goodness-of-Fit Testing in High Dimensional Generalized
Linear Models.”</span> <em>Journal of the Royal Statistical Society:
Series B (Statistical Methodology)</em> 82 (3): 773–95. <a href="https://doi.org/10.1111/rssb.12371" class="external-link">https://doi.org/10.1111/rssb.12371</a>.
</div>
<div id="ref-meinshausen2010" class="csl-entry">
Meinshausen, Nicolai, and Peter Bühlmann. 2010. <span>“Stability
Selection.”</span> <em>Journal of the Royal Statistical Society: Series
B (Statistical Methodology)</em> 72 (4): 417–73. <a href="https://doi.org/10.1111/j.1467-9868.2010.00740.x" class="external-link">https://doi.org/10.1111/j.1467-9868.2010.00740.x</a>.
</div>
<div id="ref-meinshausen2009" class="csl-entry">
Meinshausen, Nicolai, Lukas Meier, and Peter Bühlmann. 2009.
<span>“<em>P</em> -<span>Values</span> for
<span>High</span>-<span>Dimensional</span>
<span>Regression</span>.”</span> <em>Journal of the American Statistical
Association</em> 104 (488): 1671–81. <a href="https://doi.org/10.1198/jasa.2009.tm08647" class="external-link">https://doi.org/10.1198/jasa.2009.tm08647</a>.
</div>
<div id="ref-shah2018" class="csl-entry">
Shah, Rajen D., and Peter Bühlmann. 2018. <span>“Goodness-of-Fit Tests
for High Dimensional Linear Models.”</span> <em>Journal of the Royal
Statistical Society: Series B (Statistical Methodology)</em> 80 (1):
113–35. <a href="https://doi.org/10.1111/rssb.12234" class="external-link">https://doi.org/10.1111/rssb.12234</a>.
</div>
<div id="ref-shah2013" class="csl-entry">
Shah, Rajen D., and Richard J. Samworth. 2013. <span>“Variable Selection
with Error Control: Another Look at Stability Selection.”</span>
<em>Journal of the Royal Statistical Society: Series B (Statistical
Methodology)</em> 75 (1): 55–80. <a href="https://doi.org/10.1111/j.1467-9868.2011.01034.x" class="external-link">https://doi.org/10.1111/j.1467-9868.2011.01034.x</a>.
</div>
<div id="ref-rRPtests" class="csl-entry">
Shah, Rajen, and Peter Buhlmann. 2021. <em>RPtests: Goodness of Fit
Tests for High-Dimensional Linear Regression Models</em>. <a href="https://CRAN.R-project.org/package=RPtests" class="external-link">https://CRAN.R-project.org/package=RPtests</a>.
</div>
<div id="ref-tibshirani1996" class="csl-entry">
Tibshirani, Robert. 1996. <span>“Regression <span>Shrinkage</span> and
<span>Selection</span> <span>Via</span> the <span>Lasso</span>.”</span>
<em>Journal of the Royal Statistical Society: Series B
(Methodological)</em> 58 (1): 267–88. <a href="https://doi.org/10.1111/j.2517-6161.1996.tb02080.x" class="external-link">https://doi.org/10.1111/j.2517-6161.1996.tb02080.x</a>.
</div>
<div id="ref-wasserman2009" class="csl-entry">
Wasserman, Larry, and Kathryn Roeder. 2009.
<span>“High-<span>Dimensional</span> <span>Variable</span>
<span>Selection</span>.”</span> <em>The Annals of Statistics</em> 37
(5A): 2178–2201. <a href="https://www.jstor.org/stable/30243702" class="external-link">https://www.jstor.org/stable/30243702</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joshua R Loftus.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
